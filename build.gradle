plugins {
    id 'java'
    id 'idea'
    id 'eclipse'
    id 'groovy'
    id "com.github.johnrengelman.shadow" version "5.1.0"
}

repositories {
    mavenCentral()
    maven { url "http://repo.dmulloy2.net/nexus/repository/public/" }
}

group 'raindance'
version '1.0-SNAPSHOT'

sourceCompatibility = 1.8

dependencies {
    implementation('com.comphenix.protocol:ProtocolLib:4.4.0')

    implementation('org.redisson:redisson:3.11.3')

    testImplementation('org.slf4j:slf4j-simple:1.7.21')
    testImplementation('org.junit.jupiter:junit-jupiter:5.5.1')
    testImplementation "org.junit.jupiter:junit-jupiter-params:5.5.1"
    testImplementation('org.junit.jupiter:junit-jupiter-api:5.5.1')


    testRuntimeOnly('io.netty:netty-bom:4.1.38.Final')
    testRuntimeOnly "org.junit.vintage:junit-vintage-engine:5.5.1"
    testRuntimeOnly('org.junit.jupiter:junit-jupiter-engine:5.5.1')

    implementation fileTree('libs')
}

task copyjar(type: Exec) {
    workingDir '.'
    commandLine 'sh', 'copy.sh'
}

test {
    useJUnitPlatform()
    systemProperty "lobby.code", "dom1234132"

    testLogging.showStandardStreams true
}

shadowJar {
    mergeServiceFiles()
    exclude "spigot.jar"
    exclude "com.comphenix.protocol:ProtocolLib:4.4.0"

    relocate("io.netty", "org.redisson.netty")
}
task fatJar(type: Jar) {
    manifest {
        attributes 'Implementation-Title': 'Champions',
                'Implementation-Version': 1.0,
                'Main-Class': 'me.raindance.champions.Main'
    }
    baseName = project.name + '-all'
    from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
    with jar
}